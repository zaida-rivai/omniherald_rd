{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "c764b979-ad93-4cf2-8942-97d942922103",
   "metadata": {},
   "outputs": [],
   "source": [
    "# sources \n",
    "# https://open-meteo.com/en/docs/historical-weather-api#hourly=temperature_2m,relative_humidity_2m,dew_point_2m"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "048c230e-e2a5-496d-b5b0-6ff32d777487",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: openmeteo-requests in /usr/local/lib/python3.11/site-packages (1.1.0)\n",
      "Requirement already satisfied: openmeteo-sdk>=1.4.0 in /usr/local/lib/python3.11/site-packages (from openmeteo-requests) (1.7.0)\n",
      "Requirement already satisfied: requests in /usr/local/lib/python3.11/site-packages (from openmeteo-requests) (2.31.0)\n",
      "Requirement already satisfied: flatbuffers>=23.0.0 in /usr/local/lib/python3.11/site-packages (from openmeteo-sdk>=1.4.0->openmeteo-requests) (23.5.26)\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/site-packages (from requests->openmeteo-requests) (3.2.0)\n",
      "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/site-packages (from requests->openmeteo-requests) (2.10)\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/site-packages (from requests->openmeteo-requests) (1.26.16)\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/site-packages (from requests->openmeteo-requests) (2023.7.22)\n",
      "\n",
      "\u001b[1m[\u001b[0m\u001b[34;49mnotice\u001b[0m\u001b[1;39;49m]\u001b[0m\u001b[39;49m A new release of pip is available: \u001b[0m\u001b[31;49m23.2.1\u001b[0m\u001b[39;49m -> \u001b[0m\u001b[32;49m23.3.1\u001b[0m\n",
      "\u001b[1m[\u001b[0m\u001b[34;49mnotice\u001b[0m\u001b[1;39;49m]\u001b[0m\u001b[39;49m To update, run: \u001b[0m\u001b[32;49mpython3.11 -m pip install --upgrade pip\u001b[0m\n",
      "Requirement already satisfied: requests-cache in /usr/local/lib/python3.11/site-packages (1.1.1)\n",
      "Requirement already satisfied: retry-requests in /usr/local/lib/python3.11/site-packages (2.0.0)\n",
      "Requirement already satisfied: numpy in /usr/local/lib/python3.11/site-packages (1.23.5)\n",
      "Requirement already satisfied: pandas in /usr/local/lib/python3.11/site-packages (2.0.1)\n",
      "Requirement already satisfied: attrs>=21.2 in /usr/local/lib/python3.11/site-packages (from requests-cache) (23.1.0)\n",
      "Requirement already satisfied: cattrs>=22.2 in /usr/local/lib/python3.11/site-packages (from requests-cache) (23.2.3)\n",
      "Requirement already satisfied: platformdirs>=2.5 in /usr/local/lib/python3.11/site-packages (from requests-cache) (3.10.0)\n",
      "Requirement already satisfied: requests>=2.22 in /usr/local/lib/python3.11/site-packages (from requests-cache) (2.31.0)\n",
      "Requirement already satisfied: url-normalize>=1.4 in /usr/local/lib/python3.11/site-packages (from requests-cache) (1.4.3)\n",
      "Requirement already satisfied: urllib3>=1.25.5 in /usr/local/lib/python3.11/site-packages (from requests-cache) (1.26.16)\n",
      "Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.11/site-packages (from pandas) (2.8.2)\n",
      "Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.11/site-packages (from pandas) (2023.3)\n",
      "Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.11/site-packages (from pandas) (2023.3)\n",
      "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/site-packages (from python-dateutil>=2.8.2->pandas) (1.16.0)\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/site-packages (from requests>=2.22->requests-cache) (3.2.0)\n",
      "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/site-packages (from requests>=2.22->requests-cache) (2.10)\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/site-packages (from requests>=2.22->requests-cache) (2023.7.22)\n",
      "\n",
      "\u001b[1m[\u001b[0m\u001b[34;49mnotice\u001b[0m\u001b[1;39;49m]\u001b[0m\u001b[39;49m A new release of pip is available: \u001b[0m\u001b[31;49m23.2.1\u001b[0m\u001b[39;49m -> \u001b[0m\u001b[32;49m23.3.1\u001b[0m\n",
      "\u001b[1m[\u001b[0m\u001b[34;49mnotice\u001b[0m\u001b[1;39;49m]\u001b[0m\u001b[39;49m To update, run: \u001b[0m\u001b[32;49mpython3.11 -m pip install --upgrade pip\u001b[0m\n",
      "Collecting geopy\n",
      "  Obtaining dependency information for geopy from https://files.pythonhosted.org/packages/e5/15/cf2a69ade4b194aa524ac75112d5caac37414b20a3a03e6865dfe0bd1539/geopy-2.4.1-py3-none-any.whl.metadata\n",
      "  Downloading geopy-2.4.1-py3-none-any.whl.metadata (6.8 kB)\n",
      "Collecting geographiclib<3,>=1.52 (from geopy)\n",
      "  Downloading geographiclib-2.0-py3-none-any.whl (40 kB)\n",
      "\u001b[2K     \u001b[38;2;114;156;31m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m40.3/40.3 kB\u001b[0m \u001b[31m1.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
      "\u001b[?25hDownloading geopy-2.4.1-py3-none-any.whl (125 kB)\n",
      "\u001b[2K   \u001b[38;2;114;156;31m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m125.4/125.4 kB\u001b[0m \u001b[31m4.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
      "\u001b[?25hInstalling collected packages: geographiclib, geopy\n",
      "Successfully installed geographiclib-2.0 geopy-2.4.1\n",
      "\n",
      "\u001b[1m[\u001b[0m\u001b[34;49mnotice\u001b[0m\u001b[1;39;49m]\u001b[0m\u001b[39;49m A new release of pip is available: \u001b[0m\u001b[31;49m23.2.1\u001b[0m\u001b[39;49m -> \u001b[0m\u001b[32;49m23.3.1\u001b[0m\n",
      "\u001b[1m[\u001b[0m\u001b[34;49mnotice\u001b[0m\u001b[1;39;49m]\u001b[0m\u001b[39;49m To update, run: \u001b[0m\u001b[32;49mpython3.11 -m pip install --upgrade pip\u001b[0m\n"
     ]
    }
   ],
   "source": [
    "!pip install openmeteo-requests\n",
    "!pip install requests-cache retry-requests numpy pandas\n",
    "!pip install geopy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "id": "a3556c23-aebc-4fe4-bbd5-e7de7a81ccd9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "9.9325427 latitude\n",
      "-84.0795782 longitude\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[9.9325427, -84.0795782]"
      ]
     },
     "execution_count": 70,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "294a2246-5544-457e-a3e7-34a871682200",
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "'[' was never closed (468371058.py, line 1)",
     "output_type": "error",
     "traceback": [
      "\u001b[0;36m  Cell \u001b[0;32mIn[53], line 1\u001b[0;36m\u001b[0m\n\u001b[0;31m    COUNTRY_CODES = {\"portugal\":[38.736946, -9.142685\u001b[0m\n\u001b[0m                                ^\u001b[0m\n\u001b[0;31mSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m '[' was never closed\n"
     ]
    }
   ],
   "source": [
    "COUNTRY_CODES = {\"portugal\":[38.736946, -9.142685],\n",
    "                \"sacramento\":[38.575764, -121.478851]\n",
    "                \"\":[]}\n",
    "\n",
    "TODAY = datetime.utcnow().strftime(\"%Y-%m-%d\")\n",
    "LATITUDE, LONGITUDE = 38.736946, -9.142685\n",
    "HISTORICAL_DATA = 10 \n",
    "START_DATE = (datetime.utcnow() - relativedelta(years=HISTORICAL_DATA)).strftime(\"%Y-%m-%d\")\n",
    "END_DATE = datetime.utcnow().strftime(\"%Y-%m-%d\")\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "id": "95bdbca5-7a25-4c13-9bb7-60a261db50ec",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "38.7077507 latitude\n",
      "-9.1365919 longitude\n",
      "Coordinates 38.69947052001953°E -9.1961669921875°N\n",
      "Elevation 7.0 m asl\n",
      "Timezone None None\n",
      "Timezone difference to GMT+0 0 s\n"
     ]
    }
   ],
   "source": [
    "import openmeteo_requests\n",
    "import requests_cache\n",
    "import pandas as pd\n",
    "from retry_requests import retry\n",
    "from datetime import date, datetime\n",
    "from dateutil.relativedelta import relativedelta\n",
    "\n",
    "import requests\n",
    "import urllib.parse\n",
    "from geopy.geocoders import Nominatim\n",
    "\n",
    "def get_lan_long(location):\n",
    "    \n",
    "    # Initialize Nominatim API\n",
    "    geolocator = Nominatim(user_agent=\"MyApp\")\n",
    "    location = geolocator.geocode(location)\n",
    "    print(\"{} latitude\\n{} longitude\".format(location.latitude, location.longitude))\n",
    "    \n",
    "    return location.latitude, location.longitude\n",
    "\n",
    "\n",
    "LATITUDE, LONGITUDE = get_lan_long(\"Lisboa, Portugal\")\n",
    "\n",
    "\n",
    "# Setup the Open-Meteo API client with cache and retry on error\n",
    "cache_session = requests_cache.CachedSession('.cache', expire_after = -1)\n",
    "retry_session = retry(cache_session, retries = 5, backoff_factor = 0.2)\n",
    "openmeteo = openmeteo_requests.Client(session = retry_session)\n",
    "\n",
    "# Make sure all required weather variables are listed here\n",
    "# The order of variables in hourly or daily is important to assign them correctly below\n",
    "url = \"https://archive-api.open-meteo.com/v1/archive\"\n",
    "params = {\n",
    "\t\"latitude\": LATITUDE,\n",
    "\t\"longitude\": LONGITUDE,\n",
    "\t\"start_date\": START_DATE,\n",
    "\t\"end_date\": TODAY,\n",
    "\t\"hourly\": [\"temperature_2m\", \"relative_humidity_2m\", \"dew_point_2m\", \"rain\", \"wind_speed_10m\", \"wind_speed_100m\", \"wind_direction_10m\", \"wind_direction_100m\", \"wind_gusts_10m\", \"soil_temperature_0_to_7cm\", \"soil_temperature_7_to_28cm\", \"soil_temperature_28_to_100cm\", \"soil_temperature_100_to_255cm\", \"soil_moisture_0_to_7cm\", \"soil_moisture_7_to_28cm\", \"soil_moisture_28_to_100cm\", \"soil_moisture_100_to_255cm\", \"shortwave_radiation\", \"direct_radiation\", \"diffuse_radiation\", \"direct_normal_irradiance\", \"terrestrial_radiation\", \"shortwave_radiation_instant\", \"direct_radiation_instant\", \"diffuse_radiation_instant\", \"direct_normal_irradiance_instant\", \"terrestrial_radiation_instant\"]\n",
    "}\n",
    "responses = openmeteo.weather_api(url, params=params)\n",
    "\n",
    "# Process first location. Add a for-loop for multiple locations or weather models\n",
    "response = responses[0]\n",
    "print(f\"Coordinates {response.Latitude()}°E {response.Longitude()}°N\")\n",
    "print(f\"Elevation {response.Elevation()} m asl\")\n",
    "print(f\"Timezone {response.Timezone()} {response.TimezoneAbbreviation()}\")\n",
    "print(f\"Timezone difference to GMT+0 {response.UtcOffsetSeconds()} s\")\n",
    "\n",
    "# Process hourly data. The order of variables needs to be the same as requested.\n",
    "hourly = response.Hourly()\n",
    "hourly_temperature_2m = hourly.Variables(0).ValuesAsNumpy()\n",
    "hourly_relative_humidity_2m = hourly.Variables(1).ValuesAsNumpy()\n",
    "hourly_dew_point_2m = hourly.Variables(2).ValuesAsNumpy()\n",
    "hourly_rain = hourly.Variables(3).ValuesAsNumpy()\n",
    "hourly_wind_speed_10m = hourly.Variables(4).ValuesAsNumpy()\n",
    "hourly_wind_speed_100m = hourly.Variables(5).ValuesAsNumpy()\n",
    "hourly_wind_direction_10m = hourly.Variables(6).ValuesAsNumpy()\n",
    "hourly_wind_direction_100m = hourly.Variables(7).ValuesAsNumpy()\n",
    "hourly_wind_gusts_10m = hourly.Variables(8).ValuesAsNumpy()\n",
    "hourly_soil_temperature_0_to_7cm = hourly.Variables(9).ValuesAsNumpy()\n",
    "hourly_soil_temperature_7_to_28cm = hourly.Variables(10).ValuesAsNumpy()\n",
    "hourly_soil_temperature_28_to_100cm = hourly.Variables(11).ValuesAsNumpy()\n",
    "hourly_soil_temperature_100_to_255cm = hourly.Variables(12).ValuesAsNumpy()\n",
    "hourly_soil_moisture_0_to_7cm = hourly.Variables(13).ValuesAsNumpy()\n",
    "hourly_soil_moisture_7_to_28cm = hourly.Variables(14).ValuesAsNumpy()\n",
    "hourly_soil_moisture_28_to_100cm = hourly.Variables(15).ValuesAsNumpy()\n",
    "hourly_soil_moisture_100_to_255cm = hourly.Variables(16).ValuesAsNumpy()\n",
    "hourly_shortwave_radiation = hourly.Variables(17).ValuesAsNumpy()\n",
    "hourly_direct_radiation = hourly.Variables(18).ValuesAsNumpy()\n",
    "hourly_diffuse_radiation = hourly.Variables(19).ValuesAsNumpy()\n",
    "hourly_direct_normal_irradiance = hourly.Variables(20).ValuesAsNumpy()\n",
    "hourly_terrestrial_radiation = hourly.Variables(21).ValuesAsNumpy()\n",
    "hourly_shortwave_radiation_instant = hourly.Variables(22).ValuesAsNumpy()\n",
    "hourly_direct_radiation_instant = hourly.Variables(23).ValuesAsNumpy()\n",
    "hourly_diffuse_radiation_instant = hourly.Variables(24).ValuesAsNumpy()\n",
    "hourly_direct_normal_irradiance_instant = hourly.Variables(25).ValuesAsNumpy()\n",
    "hourly_terrestrial_radiation_instant = hourly.Variables(26).ValuesAsNumpy()\n",
    "\n",
    "hourly_data = {\"date\": pd.date_range(\n",
    "\tstart = pd.to_datetime(hourly.Time(), unit = \"s\"),\n",
    "\tend = pd.to_datetime(hourly.TimeEnd(), unit = \"s\"),\n",
    "\tfreq = pd.Timedelta(seconds = hourly.Interval()),\n",
    "\tinclusive = \"left\"\n",
    ")}\n",
    "hourly_data[\"temperature_2m\"] = hourly_temperature_2m\n",
    "hourly_data[\"relative_humidity_2m\"] = hourly_relative_humidity_2m\n",
    "hourly_data[\"dew_point_2m\"] = hourly_dew_point_2m\n",
    "hourly_data[\"rain\"] = hourly_rain\n",
    "hourly_data[\"wind_speed_10m\"] = hourly_wind_speed_10m\n",
    "hourly_data[\"wind_speed_100m\"] = hourly_wind_speed_100m\n",
    "hourly_data[\"wind_direction_10m\"] = hourly_wind_direction_10m\n",
    "hourly_data[\"wind_direction_100m\"] = hourly_wind_direction_100m\n",
    "hourly_data[\"wind_gusts_10m\"] = hourly_wind_gusts_10m\n",
    "hourly_data[\"soil_temperature_0_to_7cm\"] = hourly_soil_temperature_0_to_7cm\n",
    "hourly_data[\"soil_temperature_7_to_28cm\"] = hourly_soil_temperature_7_to_28cm\n",
    "hourly_data[\"soil_temperature_28_to_100cm\"] = hourly_soil_temperature_28_to_100cm\n",
    "hourly_data[\"soil_temperature_100_to_255cm\"] = hourly_soil_temperature_100_to_255cm\n",
    "hourly_data[\"soil_moisture_0_to_7cm\"] = hourly_soil_moisture_0_to_7cm\n",
    "hourly_data[\"soil_moisture_7_to_28cm\"] = hourly_soil_moisture_7_to_28cm\n",
    "hourly_data[\"soil_moisture_28_to_100cm\"] = hourly_soil_moisture_28_to_100cm\n",
    "hourly_data[\"soil_moisture_100_to_255cm\"] = hourly_soil_moisture_100_to_255cm\n",
    "hourly_data[\"shortwave_radiation\"] = hourly_shortwave_radiation\n",
    "hourly_data[\"direct_radiation\"] = hourly_direct_radiation\n",
    "hourly_data[\"diffuse_radiation\"] = hourly_diffuse_radiation\n",
    "hourly_data[\"direct_normal_irradiance\"] = hourly_direct_normal_irradiance\n",
    "hourly_data[\"terrestrial_radiation\"] = hourly_terrestrial_radiation\n",
    "hourly_data[\"shortwave_radiation_instant\"] = hourly_shortwave_radiation_instant\n",
    "hourly_data[\"direct_radiation_instant\"] = hourly_direct_radiation_instant\n",
    "hourly_data[\"diffuse_radiation_instant\"] = hourly_diffuse_radiation_instant\n",
    "hourly_data[\"direct_normal_irradiance_instant\"] = hourly_direct_normal_irradiance_instant\n",
    "hourly_data[\"terrestrial_radiation_instant\"] = hourly_terrestrial_radiation_instant\n",
    "\n",
    "hourly_dataframe = pd.DataFrame(data = hourly_data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "7638a32c-4b74-4cfe-af34-91873efb28e9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>temperature_2m</th>\n",
       "      <th>relative_humidity_2m</th>\n",
       "      <th>dew_point_2m</th>\n",
       "      <th>rain</th>\n",
       "      <th>wind_speed_10m</th>\n",
       "      <th>wind_speed_100m</th>\n",
       "      <th>wind_direction_10m</th>\n",
       "      <th>wind_direction_100m</th>\n",
       "      <th>wind_gusts_10m</th>\n",
       "      <th>...</th>\n",
       "      <th>shortwave_radiation</th>\n",
       "      <th>direct_radiation</th>\n",
       "      <th>diffuse_radiation</th>\n",
       "      <th>direct_normal_irradiance</th>\n",
       "      <th>terrestrial_radiation</th>\n",
       "      <th>shortwave_radiation_instant</th>\n",
       "      <th>direct_radiation_instant</th>\n",
       "      <th>diffuse_radiation_instant</th>\n",
       "      <th>direct_normal_irradiance_instant</th>\n",
       "      <th>terrestrial_radiation_instant</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2013-12-15 00:00:00</td>\n",
       "      <td>10.493999</td>\n",
       "      <td>84.801163</td>\n",
       "      <td>8.044</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10.594036</td>\n",
       "      <td>19.134262</td>\n",
       "      <td>80.217659</td>\n",
       "      <td>94.315948</td>\n",
       "      <td>17.280001</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2013-12-15 01:00:00</td>\n",
       "      <td>10.094000</td>\n",
       "      <td>86.211983</td>\n",
       "      <td>7.894</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10.538843</td>\n",
       "      <td>18.486622</td>\n",
       "      <td>82.146782</td>\n",
       "      <td>96.709740</td>\n",
       "      <td>17.280001</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2013-12-15 02:00:00</td>\n",
       "      <td>9.794000</td>\n",
       "      <td>87.363953</td>\n",
       "      <td>7.794</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11.165805</td>\n",
       "      <td>18.782204</td>\n",
       "      <td>88.152428</td>\n",
       "      <td>102.171448</td>\n",
       "      <td>17.639999</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2013-12-15 03:00:00</td>\n",
       "      <td>9.544000</td>\n",
       "      <td>88.238266</td>\n",
       "      <td>7.694</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11.212135</td>\n",
       "      <td>18.792551</td>\n",
       "      <td>95.527451</td>\n",
       "      <td>110.170738</td>\n",
       "      <td>18.719999</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2013-12-15 04:00:00</td>\n",
       "      <td>9.444000</td>\n",
       "      <td>88.832947</td>\n",
       "      <td>7.694</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10.182337</td>\n",
       "      <td>17.072504</td>\n",
       "      <td>98.130020</td>\n",
       "      <td>114.943878</td>\n",
       "      <td>19.080000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87667</th>\n",
       "      <td>2023-12-15 19:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87668</th>\n",
       "      <td>2023-12-15 20:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87669</th>\n",
       "      <td>2023-12-15 21:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87670</th>\n",
       "      <td>2023-12-15 22:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87671</th>\n",
       "      <td>2023-12-15 23:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>87672 rows × 28 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     date  temperature_2m  relative_humidity_2m  dew_point_2m   \n",
       "0     2013-12-15 00:00:00       10.493999             84.801163         8.044  \\\n",
       "1     2013-12-15 01:00:00       10.094000             86.211983         7.894   \n",
       "2     2013-12-15 02:00:00        9.794000             87.363953         7.794   \n",
       "3     2013-12-15 03:00:00        9.544000             88.238266         7.694   \n",
       "4     2013-12-15 04:00:00        9.444000             88.832947         7.694   \n",
       "...                   ...             ...                   ...           ...   \n",
       "87667 2023-12-15 19:00:00             NaN                   NaN           NaN   \n",
       "87668 2023-12-15 20:00:00             NaN                   NaN           NaN   \n",
       "87669 2023-12-15 21:00:00             NaN                   NaN           NaN   \n",
       "87670 2023-12-15 22:00:00             NaN                   NaN           NaN   \n",
       "87671 2023-12-15 23:00:00             NaN                   NaN           NaN   \n",
       "\n",
       "       rain  wind_speed_10m  wind_speed_100m  wind_direction_10m   \n",
       "0       0.0       10.594036        19.134262           80.217659  \\\n",
       "1       0.0       10.538843        18.486622           82.146782   \n",
       "2       0.0       11.165805        18.782204           88.152428   \n",
       "3       0.0       11.212135        18.792551           95.527451   \n",
       "4       0.0       10.182337        17.072504           98.130020   \n",
       "...     ...             ...              ...                 ...   \n",
       "87667   NaN             NaN              NaN                 NaN   \n",
       "87668   NaN             NaN              NaN                 NaN   \n",
       "87669   NaN             NaN              NaN                 NaN   \n",
       "87670   NaN             NaN              NaN                 NaN   \n",
       "87671   NaN             NaN              NaN                 NaN   \n",
       "\n",
       "       wind_direction_100m  wind_gusts_10m  ...  shortwave_radiation   \n",
       "0                94.315948       17.280001  ...                  0.0  \\\n",
       "1                96.709740       17.280001  ...                  0.0   \n",
       "2               102.171448       17.639999  ...                  0.0   \n",
       "3               110.170738       18.719999  ...                  0.0   \n",
       "4               114.943878       19.080000  ...                  0.0   \n",
       "...                    ...             ...  ...                  ...   \n",
       "87667                  NaN             NaN  ...                  NaN   \n",
       "87668                  NaN             NaN  ...                  NaN   \n",
       "87669                  NaN             NaN  ...                  NaN   \n",
       "87670                  NaN             NaN  ...                  NaN   \n",
       "87671                  NaN             NaN  ...                  NaN   \n",
       "\n",
       "       direct_radiation  diffuse_radiation  direct_normal_irradiance   \n",
       "0                   0.0                0.0                       0.0  \\\n",
       "1                   0.0                0.0                       0.0   \n",
       "2                   0.0                0.0                       0.0   \n",
       "3                   0.0                0.0                       0.0   \n",
       "4                   0.0                0.0                       0.0   \n",
       "...                 ...                ...                       ...   \n",
       "87667               NaN                NaN                       NaN   \n",
       "87668               NaN                NaN                       NaN   \n",
       "87669               NaN                NaN                       NaN   \n",
       "87670               NaN                NaN                       NaN   \n",
       "87671               NaN                NaN                       NaN   \n",
       "\n",
       "       terrestrial_radiation  shortwave_radiation_instant   \n",
       "0                        0.0                          0.0  \\\n",
       "1                        0.0                          0.0   \n",
       "2                        0.0                          0.0   \n",
       "3                        0.0                          0.0   \n",
       "4                        0.0                          0.0   \n",
       "...                      ...                          ...   \n",
       "87667                    0.0                          NaN   \n",
       "87668                    0.0                          NaN   \n",
       "87669                    0.0                          NaN   \n",
       "87670                    0.0                          NaN   \n",
       "87671                    0.0                          NaN   \n",
       "\n",
       "       direct_radiation_instant  diffuse_radiation_instant   \n",
       "0                           0.0                        0.0  \\\n",
       "1                           0.0                        0.0   \n",
       "2                           0.0                        0.0   \n",
       "3                           0.0                        0.0   \n",
       "4                           0.0                        0.0   \n",
       "...                         ...                        ...   \n",
       "87667                       NaN                        NaN   \n",
       "87668                       NaN                        NaN   \n",
       "87669                       NaN                        NaN   \n",
       "87670                       NaN                        NaN   \n",
       "87671                       NaN                        NaN   \n",
       "\n",
       "       direct_normal_irradiance_instant  terrestrial_radiation_instant  \n",
       "0                                   0.0                            0.0  \n",
       "1                                   0.0                            0.0  \n",
       "2                                   0.0                            0.0  \n",
       "3                                   0.0                            0.0  \n",
       "4                                   0.0                            0.0  \n",
       "...                                 ...                            ...  \n",
       "87667                               NaN                            0.0  \n",
       "87668                               NaN                            0.0  \n",
       "87669                               NaN                            0.0  \n",
       "87670                               NaN                            0.0  \n",
       "87671                               NaN                            0.0  \n",
       "\n",
       "[87672 rows x 28 columns]"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "hourly_dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4647c26d-ee04-44fe-8561-2cef7facca59",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
